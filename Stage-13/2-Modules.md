<h1>Kernel Module Interface</h1> <p>These routines are invoked from within system calls/interrupts/exception handler. A user program is not allowed to call a kernel module directly.</p> <p>While executing a blocking system call, a process may block inside a module. In that case, the module will invoke the scheduler to execute other processes. The OS, in fact, is designed in such a way that blocking can happen only inside modules. Each module may contain calls to other modules (made through the CALL instruction). A module returns to its caller using the RET instruction. Modules may also be called from interrupt/exception handlers. Note that a process remains in the kernel mode through out the execution (as well as entry and exit) of a module.</p> <p>A module may implement several functions. Each function within a module is identified by a function number which must be passed as an argument to the module through register R1. Other arguments must be passed through registers R2, R3 etc. in that order. The return value from a module must be passed through register R0. (See SPL documentation on module calling conventions <a href=[../support-tools/spl/](https://exposnitc.github.io/expos-docs/support-tools/spl/) >here</a>. )</p> <p>The kernel modules and the functions present in each module are described below.</p> <h3 id=module-0-resource-manager><a href=[module-00/](https://exposnitc.github.io/expos-docs/modules/module-00/) >module-0 : Resource Manager</a><a class=headerlink href=[#module-0-resource-manager](https://exposnitc.github.io/expos-docs/modules/#module-0-resource-manager) title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Function Number</th> <th>Function Name</th> <th>Arguments</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>Acquire Buffer</td> <td>Buffer Number, PID</td> </tr> <tr> <td>2</td> <td>Release Buffer</td> <td>Buffer Number, PID</td> </tr> <tr> <td>3</td> <td>Acquire Disk*</td> <td>PID</td> </tr> <tr> <td>4</td> <td>Acquire Inode</td> <td>Inodeindex, PID</td> </tr> <tr> <td>5</td> <td>Release Inode</td> <td>Inodeindex, PID</td> </tr> <tr> <td>6</td> <td>Acquire Semaphore</td> <td>PID</td> </tr> <tr> <td>7</td> <td>Release Semaphore</td> <td>PID</td> </tr> <tr> <td>8</td> <td>Acquire Terminal</td> <td>PID</td> </tr> <tr> <td>9</td> <td>Release Terminal</td> <td>PID</td> </tr> </tbody> </table> <p>*Release function for the disk is implimented in the disk interrupt handler.</p> <h3 id=module-1-process-manager><a href=[module-01/](https://exposnitc.github.io/expos-docs/modules/module-01/) >module-1 : Process Manager</a><a class=headerlink href=[#module-1-process-manager](https://exposnitc.github.io/expos-docs/modules/#module-1-process-manager) title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Function Number</th> <th>Function Name</th> <th>Arguments</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>Get Pcb Entry</td> <td>NIL</td> </tr> <tr> <td>2</td> <td>Free User Area Page</td> <td>PID</td> </tr> <tr> <td>3</td> <td>Exit Process</td> <td>PID</td> </tr> <tr> <td>4</td> <td>Free Page Table</td> <td>PID</td> </tr> <tr> <td>5</td> <td>Kill All</td> <td>PID</td> </tr> </tbody> </table> <h3 id=module-2-memory-manager><a href=[module-02/](https://exposnitc.github.io/expos-docs/modules/module-02/) >module-2 : Memory Manager</a><a class=headerlink href=[#module-2-memory-manager](https://exposnitc.github.io/expos-docs/modules/#module-2-memory-manager) title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Function Number</th> <th>Function Name</th> <th>Arguments</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>Get Free Page</td> <td>NIL</td> </tr> <tr> <td>2</td> <td>Release Page</td> <td>Page Number</td> </tr> <tr> <td>3</td> <td>Get Free Block</td> <td>NIL</td> </tr> <tr> <td>4</td> <td>Release Block</td> <td>Block Number</td> </tr> <tr> <td>5</td> <td>Get Code Page</td> <td>Block Number, PID</td> </tr> <tr> <td>6</td> <td>Get Swap Block</td> <td>NIL</td> </tr> </tbody> </table> <h3 id=module-3-file-manager><a href=[module-03/](https://exposnitc.github.io/expos-docs/modules/module-03/) >module-3 : File Manager</a><a class=headerlink href=[#module-3-file-manager](https://exposnitc.github.io/expos-docs/modules/#module-3-file-manager) title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Function Number</th> <th>Function Name</th> <th>Arguments</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>Buffered Write</td> <td>Disk Block Number, Offset, Word</td> </tr> <tr> <td>2</td> <td>Buffered Read</td> <td>Disk Block Number, Offset, Memory Address</td> </tr> <tr> <td>3</td> <td>Open</td> <td>File Name</td> </tr> <tr> <td>4</td> <td>Close</td> <td>File Table Index</td> </tr> </tbody> </table> <h3 id=module-4-device-manager><a href=[module-04/](https://exposnitc.github.io/expos-docs/modules/module-04/) >module-4 : Device Manager</a><a class=headerlink href=[#module-4-device-manager](https://exposnitc.github.io/expos-docs/modules/#module-4-device-manager) title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Function Number</th> <th>Function Name</th> <th>Arguments</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>Disk Store</td> <td>PID, Page Number, Block Number</td> </tr> <tr> <td>2</td> <td>Disk Load</td> <td>PID, Page Number, Block Number</td> </tr> <tr> <td>3</td> <td>Terminal Write</td> <td>PID, Word</td> </tr> <tr> <td>4</td> <td>Terminal Read</td> <td>PID, Address</td> </tr> </tbody> </table> <h3 id=module-5-context-switch-module-scheduler-module><a href=[module-05/](https://exposnitc.github.io/expos-docs/modules/module-05/) >module-5 : Context Switch Module (Scheduler Module)</a><a class=headerlink href=[#module-5-context-switch-module-scheduler-module](https://exposnitc.github.io/expos-docs/modules/#module-5-context-switch-module-scheduler-module) title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Function Number</th> <th>Function Name</th> <th>Arguments</th> </tr> </thead> <tbody> <tr> <td>-</td> <td>Switch Context</td> <td>Nil</td> </tr> </tbody> </table> <h3 id=module-6-pager-module><a href=[module-06/](https://exposnitc.github.io/expos-docs/modules/module-06/) >module-6 : Pager Module</a><a class=headerlink href=[#module-6-pager-module](https://exposnitc.github.io/expos-docs/modules/#module-6-pager-module) title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Function Number</th> <th>Function Name</th> <th>Arguments</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>Swap Out</td> <td>Nil</td> </tr> <tr> <td>2</td> <td>Swap In</td> <td>Nil</td> </tr> </tbody> </table> <h3 id=module-7-boot-module><a href=[module-07/](https://exposnitc.github.io/expos-docs/modules/module-07/) >module-7 : Boot Module</a><a class=headerlink href=[#module-7-boot-module](https://exposnitc.github.io/expos-docs/modules/#module-7-boot-module) title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Function Number</th> <th>Function Name</th> <th>Arguments</th> </tr> </thead> <tbody> <tr> <td>-</td> <td>-</td> <td>Nil</td> </tr> </tbody> </table> <h3 id=module-8-accesscontrol-module><a href=[module-08/](https://exposnitc.github.io/expos-docs/modules/module-08/) >module-8: AccessControl Module</a><a class=headerlink href=[#module-8-accesscontrol-module](https://exposnitc.github.io/expos-docs/modules/#module-8-accesscontrol-module) title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Function Number</th> <th>Function Name</th> <th>Arguments</th> <th>Return Value</th> </tr> </thead> <tbody> <tr> <td>ACQUIRE_KERN_LOCK = 1</td> <td>Acquire Kernel Lock</td> <td>NIL</td> <td>NIL</td> </tr> <tr> <td>ACQUIRE_SCHED_LOCK = 2</td> <td>Acquire Scheduler Lock</td> <td>NIL</td> <td>NIL</td> </tr> <tr> <td>ACQUIRE_GLOCK = 3</td> <td>Acquire Glock (Unused)</td> <td>NIL</td> <td>NIL</td> </tr> <tr> <td>RELEASE_LOCK = 4</td> <td>Release Lock</td> <td>LockVarAddress</td> <td>NIL</td> </tr> </tbody> </table> 